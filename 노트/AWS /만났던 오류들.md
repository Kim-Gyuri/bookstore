> AWSë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ë§Œë‚œ ì˜¤ë¥˜ë“¤ì„ ì •ë¦¬í•´ë‘ì—ˆë‹¤.

# ëª©ì°¨ ğŸ“Œ
+ gradle clean í–ˆì„ ë•Œ directory delete fail ì˜¤ë¥˜
+ sssh ì‰˜ ì‘ì„± ì¤‘ ambiguous redirect ì˜¤ë¥˜
+ JdbcSQLNonTransientConnectionException ì˜¤ë¥˜
+ IntelliJ Cannot resolve symbol ì˜¤ë¥˜
+ IntelliJ DB Navigator Connection error ì˜¤ë¥˜
+ Linux ì„œë²„ì—ì„œ MySQL ì ‘ì† ì˜¤ë¥˜
+ ë¹Œë“œì‹œ plain.jar ìƒì„±ë˜ëŠ” ì˜¤ë¥˜
+ S3 Error Code: PermanentRedirect ì˜¤ë¥˜
+ MultipartFile íƒ€ì… ë°ì´í„°ë¥¼ ìš”ì²­í•  ë•Œ java.lang.NullPointerException: null ì˜¤ë¥˜
+ AWS ì—°ë™í–ˆì„ ë•Œ Failed to connect to service endpoint ì˜¤ë¥˜
+ ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì¤‘ java.lang.IllegalStateException ì˜¤ë¥˜

### gradle clean í–ˆì„ ë•Œ directory delete fail ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
 ```
Unable to delete directory 'C:\Users\ê¹€ê·œë¦¬\Downloads\bookstore\build\test-results\test\binary'

build failed with an exception ; unable to delete directory xxx failed to delete some children
```
gradle window í™˜ê²½ì—ì„œ gradle clean í–ˆì„ ë•Œ "directory delete fail" ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤.  <br>
#### í•´ê²°ë°©ë²•
win+R ì—ì„œ resmonì„ ì…ë ¥í•˜ê³  í´ë¦­í•œë‹¤. <br>
cpu íƒ­ì—ì„œ ìœ„ì˜ ë©”ì‹œì§€ì— ë‚˜ì˜¨ ë””ë ‰í„°ë¦¬ íŒŒì¼ ì¤‘ì— ì‹¤í–‰ ì¤‘ì¸ ê²ƒì„ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œí•œë‹¤. <br>
java.exe ì¢…ë£Œí•˜ì—¬ gradlew clean ì„±ê³µ
> `ì°¸ê³ ` [gradle window í™˜ê²½ì—ì„œ "directory delete fail" ì˜¤ë¥˜ - ë¸”ë¡œê·¸ ê¸€](https://doubly12f.tistory.com/153)

<br>

### sssh ì‰˜ ì‘ì„± ì¤‘ ambiguous redirect ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
```
JAR NAME : [ec2-user@spring-webservice step1]$ ./deploy.sh: line 42: $1: ambiguous redirect
```
ì‘ì„±í•œ deploy.sh ì•ˆì— ì˜¤íƒ€ê°€ ìˆì–´ì„œ ë°œìƒí•œ ì˜¤ë¥˜ë‹¤.

<br>

### JdbcSQLNonTransientConnectionException ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
```
org.h2.jdbc.JdbcSQLNonTransientConnectionException:
Connection is broken: "java.net.ConnectException: Connection refused (Connection refused): localhost" [90067-200] ì˜¤ë¥˜

Factory method 'jdbcSessionDataSourceScriptDatabaseInitializer' threw exception;
nested exception is java.lang.IllegalStateException: Unable to detect database type
```
java -jar springawsbook-0.0.1-SNAPSHOT.jar í–ˆì„ ë•Œ ë°œìƒí•œ ì˜¤ë¥˜ë‹¤. <br>
+ Connection is broken ... localhost : localhost ì—°ê²°ì´ ëŠê²¼ë‹¤.
+ Unable to detect database type : database íƒ€ì…ì´ ë¶„ëª…í•˜ì§€ ëª»í•˜ë‹¤.

#### í•´ê²°ë°©ë²•
application.propertiesì—ì„œ datasourceë¥¼ ì£¼ì„ì²˜ë¦¬í•œë‹¤, <br> git pushí•˜ì—¬ ec2 ê°€ìƒì„œë²„ì— ì „ë‹¬í•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ëœë‹¤.
```
# h2
#spring.datasource.url=jdbc:h2:tcp://localhost/~/bookstore
#spring.datasource.driver-class-name=org.h2.Driver
#spring.datasource.username=sa
```
> `ì°¸ê³ ` [ec2 ë°°í¬ ì¤‘ ë§Œë‚œ ì˜¤ë¥˜ - ë¸”ë¡œê·¸ ê¸€](https://velog.io/@chang626/Chapter-08-EC2-%EC%84%9C%EB%B2%84%EC%97%90-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EB%A5%BC-%EB%B0%B0%ED%8F%AC%ED%95%B4-%EB%B3%B4%EC%9E%90)

<br>

### IntelliJ Cannot resolve symbol ì˜¤ë¥˜
![image](https://github.com/Kim-Gyuri/bookstore/assets/57389368/d1ccf4d6-3c0c-429f-9c31-1c6e863abc10)
#### í•´ê²°ë°©ë²•
+ 1ë²ˆì§¸ ë°©ë²•: ë¹Œë“œë¥¼ ë‹¤ì‹œ í•œë‹¤.
+ 2ë²ˆì§¸ ë°©ë²•: ìºì‹œë¥¼ ë¹„ìš°ê³  ì¬ì‹¤í–‰í•œë‹¤. <br> (File > Invalidate Caches/Restart)
+ 3ë²ˆì§¸ ë°©ë²•: Gradleì„ Refresh í•´ì¤€ë‹¤. <br> (ìƒë‹¨ ë©”ë‰´ë°” View > Tool Windows > Gradle)
+ 4ë²ˆì§¸ ë°©ë²•: (Build,Execution,Deployment > Build Tool > Gradle > Build and Run)ì—ì„œ  <br> ì„¤ì •ì„ ëª¨ë‘ IntelliJ IDEAë¡œ ë°”ê¿”ì¤€ë‹¤.
+ 5ë²ˆì§¸ ë°©ë²•: ìœ„ ë°©ë²•ë“¤ë¡œë„ í•´ê²°ì´ ì•ˆ ë˜ë©´, IDEë¥¼ ìµœì‹ ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸
> `ì°¸ê³ ` [IntelliJ `Cannot resolve symbol` ì—ëŸ¬ í•´ê²° ë°©ë²• ì´ì •ë¦¬ - ë¸”ë¡œê·¸ ê¸€](https://ottl-seo.tistory.com/entry/IntelliJ-Cannot-resolve-symbol-%EC%97%90%EB%9F%AC-%ED%95%B4%EA%B2%B0)

<br>

### IntelliJ DB Navigator Connection error ì˜¤ë¥˜
ì¸í…”ë¦¬ì œì´ ì»¤ë®¤ë‹ˆí‹° ë²„ì „ì—ì„œ DB í”ŒëŸ¬ê·¸ì¸ ì‹¤í–‰ ì¤‘ ë°œìƒí•œ ì˜¤ë¥˜ë‹¤. <br>
![image](https://github.com/Kim-Gyuri/bookstore/assets/57389368/d5b48413-1769-4787-871a-308552299318)
#### í•´ê²°ë°©ë²•
+ mariadb-java-client-2.7.3.jar(MariaDB ë“œë¼ì´ë²„) ì„¤ì¹˜í•œë‹¤.
+ DB ì—°ê²°í•˜ëŠ” ë¶€ë¶„ì„ ì»¤ìŠ¤í…€ìœ¼ë¡œ ì„¤ì •í•´ì„œ ì‚¬ì§„ê³¼ ê°™ì´ ìƒì„±í•œë‹¤.
> `ì°¸ê³ ` [DB Navigatorì˜ ì—°ê²°ì˜¤ë¥˜ - ê¹ƒí—ˆë¸Œ ê¸€](https://github.com/jojoldu/freelec-springboot2-webservice/issues/757)

<br>

### Linux ì„œë²„ì—ì„œ MySQL ì ‘ì† ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
```
ERROR 2003 (HY000): Can't connect to MySQL server on 
'improved-springboot-online-shopping-store.cv0zl8agiiz8.ap-northeast2.rds.amazonaws.com' (110)
Can't connect to MySQL server' (110) ë°©í™”ë²½
```
EC2ì—ì„œ RDSì— ì ‘ì†í•˜ë ¤ê³  í–ˆì„ ë•Œ, ì ‘ì† ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤. <br>
#### í•´ê²°ë°©ë²•
ëŒ€ë¶€ë¶„ ì´ìœ  ì¤‘ í•˜ë‚˜ê°€ DB ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ì‹œ ìë™ìœ¼ë¡œ ìƒì„±ëœ ë³´ì•ˆ ê·¸ë£¹ì— ìˆëŠ” <br> DB ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ê¶Œí•œì„ ë¶€ì—¬í•œ ìˆ˜ì‹  IPì£¼ì†Œì˜ ë™ê¸°í™” ë¬¸ì œë¼ê³  í•œë‹¤. <br>
("ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™ì— ë¬¸ì œ"  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.) <br><br>
ì•„ë˜ ìˆœì„œë¡œ ë³´ì•ˆê·¸ë£¹ ê·œì¹™ì„ ìˆ˜ì •í•˜ë©´, RDS ì ‘ì†ì˜¤ë¥˜ê°€ í•´ê²°ë˜ì–´ ì ‘ì†ëœë‹¤.
+ AWSì˜ VPC ì½˜ì†”ì„ ì—´ì–´ ë³´ì•ˆê·¸ë£¹ì„ í´ë¦­í•œë‹¤.
+ í•´ë‹¹ DB ì¸ìŠ¤í„´ìŠ¤ì˜ ë³´ì•ˆê·¸ë£¹ì„ ì°¾ì•„ í´ë¦­í•œë‹¤.
+  ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘ì„ í´ë¦­í•œë‹¤.
+  ì†ŒìŠ¤ë¥¼ ë¬´ê´€ìœ¼ë¡œ ë³€ê²½í•œë‹¤.
> `ì°¸ê³ ` [RDS DB ì¸ìŠ¤í„´ìŠ¤ ì—°ê²° ì˜¤ë¥˜ - ë¸”ë¡œê·¸ ê¸€](https://code4human.tistory.com/entry/AWS-RDS-DB-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%97%B0%EA%B2%B0-%EC%98%A4%EB%A5%98-ERROR-2003-HY000-Cant-connect-to-MySQL-server-on)

<br>

### ë¹Œë“œì‹œ plain.jar ìƒì„±ë˜ëŠ” ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
spring boot 2.5 ì´ìƒë¶€í„° "-plain ì´ ë¶™ì€ jar íŒŒì¼"ì´ ìƒì„±ë˜ëŠ” ì˜¤ë¥˜ë‹¤. <br>
plain.jar íŒŒì¼ì€ ëª¨ë“  ì˜ì¡´ì„±ì´ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— java -jar ëª…ë ¹ì–´ë¡œ ì‹¤í–‰ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
> "plain.jar" : <br>
> plain archive ë¼ê³ í•˜ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ì— í•„ìš”í•œ ëª¨ë“  ì˜ì¡´ì„±ì„ í¬í•¨í•˜ì§€ ì•Šê³ , <br> ì‘ì„±ëœ ì†ŒìŠ¤ì½”ë“œì˜ í´ë˜ìŠ¤ íŒŒì¼ê³¼ ë¦¬ì†ŒìŠ¤ íŒŒì¼ë§Œ í¬í•¨í•œë‹¤.
#### í•´ê²°ë°©ë²•
build.gradleì— ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.(plain.jar ìƒì„± ë°©ì§€ë¥¼ ìœ„í•œ ì„¤ì •)
```
jar {
    enabled = false
}
```
> `ì°¸ê³ ` [ë¹Œë“œì‹œ plain.jar ìƒì„± ë°©ì§€ - ë¸”ë¡œê·¸ ê¸€](https://bkjeon1614.tistory.com/705)

<br>

### S3 Error Code: PermanentRedirect ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
```
The bucket you are attempting to access must be addressed using the specified endpoint.
Please send all future requests to this endpoint.
(Service: Amazon S3; Status Code: 301; Error Code: PermanentRedirect; Request ID:)
AWS Error Code: PermanentRedirect
```
application.propertiesì— ì„¤ì •í•œ region ì •ë³´ë¥¼ ëª»ê°€ì ¸ì™€ <br> AWS S3 Clientë¥¼ ì´ìš©í•  ê²½ìš° Region ì´ ì¼ì¹˜í•˜ì§€ ì•Šì„ ë•Œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë‹¤.
#### í•´ê²°ë°©ë²•
ë¦¬í„´íƒ€ì…ì„ AmazonS3Clientë¡œ ë°”ê¾¼ë‹¤.
```java
@Bean
    public AmazonS3Client amazonS3Client() {
        BasicAWSCredentials awsCredentials = new BasicAWSCredentials(accessKey, secretKey);
        return (AmazonS3Client)AmazonS3ClientBuilder.standard()
                .withCredentials(new AWSStaticCredentialsProvider(awsCredentials))
                .withRegion(region)
                .build();
    }
```
> `ì°¸ê³ ` [S3 Error Code: PermanentRedirect - ë¸”ë¡œê·¸ ê¸€](https://velog.io/@hjin10833/AWS-S3-Error-Code-PermanentRedirect)

<br>

### MultipartFile íƒ€ì… ë°ì´í„°ë¥¼ ìš”ì²­í•  ë•Œ java.lang.NullPointerException: null ì˜¤ë¥˜
MultipartFile ì¸ìì— null ì´ ì…ë ¥ë˜ì–´ì„œ ì •ìƒì ìœ¼ë¡œ íŒŒì¼ ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ë‹¤. <br>
í•´ë‹¹ html ì½”ë“œì— ì˜¤íƒ€ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. <br>
> [MultipartFile ê´€ë ¨ null ì˜¤ë¥˜ - ë¸”ë¡œê·¸ ê¸€](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=websearch&logNo=221309319248)

<br>

### AWS ì—°ë™í–ˆì„ ë•Œ Failed to connect to service endpoint ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
awsì— ì‚¬ìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—°ë™í•´ì•¼í• ë•Œ ë°œìƒí•œ ì˜¤ë¥˜ë‹¤.
![image](https://github.com/Kim-Gyuri/bookstore/assets/57389368/12f8fa0d-697a-437e-98dd-ab6c1701bf80) <br>
> ì›ì¸ì€ aws sdk: `spring-cloud-starter-aws ì˜ì¡´ì„± ì£¼ì…ì‹œ ë¡œì»¬í™˜ê²½ì€ aws í™˜ê²½ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì—` 
#### í•´ê²°ë°©ë²•
ì•„ë˜ì™€ ê°™ì´ SpringBootApplicationì— ì ìš©ì‹œí‚¤ë©´ ëœë‹¤. <br>
```java
@SpringBootApplication(exclude = {
		org.springframework.cloud.aws.autoconfigure.context.ContextInstanceDataAutoConfiguration.class,
		org.springframework.cloud.aws.autoconfigure.context.ContextStackAutoConfiguration.class,
		org.springframework.cloud.aws.autoconfigure.context.ContextRegionProviderAutoConfiguration.class
        })
public class BookstoreApplication {

	public static void main(String[] args) {
		SpringApplication.run(BookstoreApplication.class, args);
	}

}
```
> `ì°¸ê³ ` [Failed to connect to service endpoint ì—ëŸ¬ - ë¸”ë¡œê·¸ ê¸€](https://velog.io/@yoho98/AWS-Failed-to-connect-to-service-endpoint-%EC%97%90%EB%9F%AC-umvnl0ly)

<br>

### ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì¤‘ java.lang.IllegalStateException ì˜¤ë¥˜
#### ì˜¤ë¥˜ ë‚´ìš©
```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 's3config':
Injection of autowired dependencies failed; nested exception is java.lang.IllegalArgumentException: 
Could not resolve placeholder 'cloud.aws.credentials.secret-key'
```
ë¡œì»¬ì—ì„œ gradle testí–ˆì„ ë•Œ ë°œìƒí•œ ì˜¤ë¥˜ë‹¤. <br>
+ Spring Contextê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ì„ ë•Œ ë°œìƒí•œë‹¤.
+ Bean ìƒì„± ì¤‘ì— ì˜ëª»ëœ ì¸ìë¥¼ ì „ë‹¬í•œ ê²ƒìœ¼ë¡œ ì´ë¼ê³  í•œë‹¤.
+  í…ŒìŠ¤íŠ¸ì½”ë“œê°€ ëª¨ì¡°ë¦¬ failed ëœ¬ê±¸ë¡œë´ì„œ <br> í…ŒìŠ¤íŠ¸ì½”ë“œì˜ í™˜ê²½ì„¤ì • test/resourceì—ëŠ” ì„¤ì •ì •ë³´ê°€ ì—†ì–´ì„œ ë°œìƒí•œ ê²ƒì´ë‹¤.
#### í•´ê²°ë°©ë²•
test/resourceì—ë„ application.propertiesì— s3Config ì„¤ì •ì •ë³´ë¥¼ ì ì–´ë‘”ë‹¤.
> `ì°¸ê³ ` [í…ŒìŠ¤íŠ¸ í™˜ê²½ì„¤ì • ì˜¤ë¥˜ - ë¸”ë¡œê·¸ ê¸€](https://velog.io/@yoho98/%EC%A0%A0%ED%82%A8%EC%8A%A4-%EB%B9%8C%EB%93%9C-%EC%98%A4%EB%A5%98-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95-%EC%98%A4%EB%A5%98-2lavla93)
